/*global javascripture*/(function(e){javascripture.modules.wordPanel={init:function(t){var n=this;if(!t.data("lemma"))return!1;var r=t.data("lemma").toString().split(/ |\//),i="",s="",o="",u="",a="",f="",l="",c="",h=[],p=t.data("language"),d=t.data("morph");r.forEach(function(r,v){if("undefined"==typeof javascripture.data.strongsDictionary[r])return!1;console.log(r);console.log(v);i=r;var m=javascripture.api.word.getFamily(r)+"-family "+r,g=r;console.log(g);s=javascripture.modules.hebrew.stripPointing(javascripture.data.strongsDictionary[g].lemma);o=javascripture.data.strongsDictionary[g].strongs_def;u=javascripture.data.strongsDictionary[g].derivation;l=javascripture.data.strongsDictionary[g].xlit;c=javascripture.data.strongsDictionary[g].pron;var y=javascripture.data.strongsDictionary[g].kjv_def.split(",");e.each(y,function(e,t){var n=t.trim();a+='<a href="#" class="kjv-def" data-language="kjv" data-clusivity="exclusive" data-range="word" data-lemma="'+r+'" data-word="'+n+'">'+n+"</a>, "});f=t.text();g.substring(0,1)==="H"&&(p="hebrew");g.substring(0,1)==="G"&&(p="greek");h[v]=e(".wordControlPanelTemplate").clone().removeClass("wordControlPanelTemplate").addClass("wordControlPanel");h[v].find(".wordControlPanelStrongsNumber").addClass(m).text(i).data({language:p,lemma:g,range:"verse"});h[v].find(".wordControlPanelLemma").text(s);h[v].find(".wordControlPanelEnglish").text(f);h[v].find(".wordControlPanelStrongsDef").text(o);h[v].find(".wordControlPanelDerivation").text(u);h[v].find(".wordControlPanelTransliteration").text(l);h[v].find(".wordControlPanelPronounciation").text(c);h[v].find(".wordControlPanelKJVDef").html(a);h[v].find(".wordControlPanelMorphology").html(d+": "+javascripture.api.morphology.get(d));var b="";typeof javascripture.data.strongsObjectWithFamilies[r]!="undefined"&&javascripture.data.strongsObjectWithFamilies[r].roots?e.each(javascripture.data.strongsObjectWithFamilies[r].roots,function(e,t){t.substring(0,1)==="H"&&(p="hebrew");t.substring(0,1)==="G"&&(p="greek");b+='<a href="#search='+t+'" class="'+javascripture.api.word.getFamily(t)+"-family "+t+' word-tree" data-lemma="'+t+'" data-language="'+p+'">'+t+"</a> "}):b+="No roots";var w="";b===""?w+="<p>no roots</p>":w+="roots: "+b;var E="",S=n.getBranchesMarkup(r);S===""?E+="<p>no branches</p>":E+="branches: "+S;h[v].find("#wordTreeRoots").html(w);h[v].find("#wordTreeBranches").html(E);var x=javascripture.api.word.getFamily(r),T=parseFloat(x.substring(1,x.length),10),N="family: "+x;h[v].find("#wordTreeFamily").html(N);var C=javascripture.modules.colors.getStrongsStyle(r);h[v].find("style").html(C)});e("#wordControlPanel").html(h).show();e.each(h,function(t,n){e("#wordControlPanel").append(n)});e("#wordDetailsPanel").hasClass("top")||e("#keyCode68").click()},getBranches:function(t){var n={};e.each(javascripture.data.strongsObjectWithFamilies,function(r,i){e.inArray(t,i.roots)!==-1&&(n[r]=!0)});return n},getBranchesMarkup:function(t){var n=this.getBranches(t),r="";e.each(n,function(e,t){var n;e.substring(0,1)==="H"&&(n="hebrew");e.substring(0,1)==="G"&&(n="greek");r+='<a href="#search='+e+'" class="'+javascripture.api.word.getFamily(e)+"-family "+e+' word-tree" data-lemma="'+e+'"  data-language="'+n+'">'+e+"</a> "});return r}};e(document).on("click","#verse ol > li span",function(t){t.preventDefault();t.stopPropagation();javascripture.modules.wordPanel.init(e(this))});e(document).on("click",".wordControlPanel .close",function(t){t.preventDefault();e("#wordControlPanel").hide()})})(jQuery);